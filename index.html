<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calorie & BMR Fat-loss Checker</title>
  <style>
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:#f7fafc;
      margin:0;
      padding:16px;
      color:#0f172a
    }
    h1{margin-bottom:10px}
    hr{border:none;border-top:1px solid #e5e7eb;margin:16px 0}
    label{font-weight:600;font-size:14px}
    input,select,button{
      width:100%;
      padding:10px;
      margin:6px 0 12px;
      border-radius:8px;
      border:1px solid #e5e7eb
    }
    button{
      background:#0ea5a4;
      color:#fff;
      font-weight:600;
      cursor:pointer
    }
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;border-bottom:1px solid #eee;text-align:left}
    .danger{background:#ef4444}
    .delete-btn{background:#ef4444}
    .result{font-weight:600;margin:6px 0}
  </style>
</head>
<body>

<h1>Calorie & BMR Fat-loss Checker</h1>

<label>Sex</label>
<select id="sex">
  <option value="male">Male</option>
  <option value="female">Female</option>
</select>

<label>Age</label>
<input type="number" id="age" value="18">

<label>Weight (kg)</label>
<input type="number" id="weight" step="0.1" value="61">

<label>Height (cm)</label>
<input type="number" id="height" step="0.1" value="165">

<button onclick="calcBMR()">Calculate BMR</button>
<div class="result" id="bmrResult"></div>

<hr>

<label>Meal Date</label>
<input type="date" id="mealDate">

<label>Meal Name</label>
<input type="text" id="mealName">

<label>Calories (kcal)</label>
<input type="number" id="mealCalories">

<button onclick="addMeal()">Add Meal</button>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Meal</th>
      <th>Calories</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="mealTable"></tbody>
</table>

<hr>

<label>View Date</label>
<input type="date" id="viewDate">

<div class="result">Total Calories: <span id="totalCals">0</span> kcal</div>
<div class="result">BMR: <span id="bmrVal">0</span> kcal</div>
<div class="result">Deficit: <span id="deficitVal">0</span> kcal</div>
<div class="result" id="statusText"></div>

<hr>

<label>Current Weight (kg)</label>
<input type="number" id="currentWeight" value="61" step="0.1">

<label>Target Weight (kg)</label>
<input type="number" id="targetWeight" value="50" step="0.1">

<label>Target Date</label>
<input type="date" id="targetDate" value="2026-02-01">

<button onclick="updateGoal()">Update Goal</button>
<div class="result" id="goalResult"></div>

<script>
let meals = [];

document.getElementById("mealDate").valueAsDate = new Date();
document.getElementById("viewDate").valueAsDate = new Date();

function calcBMR(){
  const sex=document.getElementById("sex").value;
  const age=+document.getElementById("age").value;
  const weight=+document.getElementById("weight").value;
  const height=+document.getElementById("height").value;

  let bmr = 10*weight + 6.25*height - 5*age + (sex==="male"?5:-161);
  document.getElementById("bmrResult").innerText = "BMR: "+Math.round(bmr)+" kcal";
  document.getElementById("bmrVal").innerText = Math.round(bmr);
  updateResults();
}

function addMeal(){
  const date=document.getElementById("mealDate").value;
  const name=document.getElementById("mealName").value;
  const cal=+document.getElementById("mealCalories").value;
  if(!date||!name||!cal) return;

  meals.push({date,name,cal});
  renderMeals();
  updateResults();

  document.getElementById("mealName").value="";
  document.getElementById("mealCalories").value="";
}

function deleteMeal(index){
  meals.splice(index,1);
  renderMeals();
  updateResults();
}

function renderMeals(){
  const tbody=document.getElementById("mealTable");
  tbody.innerHTML="";
  meals.forEach((m,index)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${m.date}</td>
      <td>${m.name}</td>
      <td>${m.cal}</td>
      <td><button class="delete-btn" onclick="deleteMeal(${index})">Delete</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function updateResults(){
  const viewDate=document.getElementById("viewDate").value;
  const total = meals.filter(m=>m.date===viewDate).reduce((s,m)=>s+m.cal,0);
  document.getElementById("totalCals").innerText=total;

  const bmr=+document.getElementById("bmrVal").innerText||0;
  const deficit=bmr-total;
  document.getElementById("deficitVal").innerText=deficit;

  const status=document.getElementById("statusText");
  if(deficit>0){
    status.innerText="You are in a calorie deficit ✅";
    status.style.color="green";
  }else{
    status.innerText="You are in a calorie surplus ❌";
    status.style.color="red";
  }
}

function updateGoal(){
  const cw=+document.getElementById("currentWeight").value;
  const tw=+document.getElementById("targetWeight").value;
  const td=new Date(document.getElementById("targetDate").value);
  const now=new Date();

  const diff=cw-tw;
  const days=Math.max(1,Math.ceil((td-now)/(1000*60*60*24)));
  const perWeek=(diff/(days/7)).toFixed(2);

  document.getElementById("goalResult").innerText =
    `Need to lose ${diff} kg in ${days} days (~${perWeek} kg/week)`;
}

calcBMR();
</script>

</body>
</html>
